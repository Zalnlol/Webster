@{
    ViewData["Title"] = "Upload file excel";
    Layout = "_LayoutQuestion";
}

<h4><b style="color: limegreen">Upload New Question</b></h4>
<br />

<form asp-action="BatchQuestionUpload" asp-controller="Question" method="post" enctype="multipart/form-data">
    <input type="file" name="batchQuestions" id="batchQuestions" onchange="validationBatchQuestions()" class="form-label" />
    <br />
    <br />
    <input type="submit" value="Upload" class="btn btn-success" />
</form>

<hr />

<p class="text-danger">@ViewBag.msg</p>
<br />
<div>
    <p>File Excel must be format like this. If you want to upload image then you drag and drop image into folder images/QA</p>
    <p><a href="~/uploadform.xlsx" style="cursor: pointer; color: limegreen;">Form Download</a></p>
    <a href="~/images/QA/Untitled5.png" data-lightbox="~/images/QA/Untitled5.png"><img src="~/images/QA/Untitled5.png" width="500" /></a>
    &nbsp; &nbsp; &nbsp; &nbsp;
    <a href="~/images/QA/Untitled7.png" data-lightbox="~/images/QA/Untitled7.png"><img src="~/images/QA/Untitled7.png" width="500" /></a>
</div>

<div>
    <a style="cursor:pointer;color: deeppink;" onclick="history.back()">Back to List</a>
</div>

<script>
    function validationBatchQuestions() {
        var fileInput = document.getElementById('batchQuestions');
        var filePath = fileInput.value;

        var allowedExtensions =
            /(\.xlsx|\.xls)$/i;

        if (!allowedExtensions.exec(filePath)) {
            alert('Must be .xlsx, .xls file!');
            fileInput.value = '';
            return false;
        } else {
            return true;
        }
    }
</script>
